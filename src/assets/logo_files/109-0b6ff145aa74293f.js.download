"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[109],{8728:function(e,t,n){n.d(t,{W:function(){return f},x:function(){return h}});var i=n(85893),r=n(964),o=n(23126),l=n(97992),a=n(80423),d=n(62288),s=n(17324),c=n(53194),u=n(96934),p=n(48583);let h={PARAGRAPH:"PARAGRAPH",OPTIONS_BUTTON:"OPTIONS_BUTTON",TEMPO_BUTTON:"TEMPO_BUTTON",ERROR_BUTTON:"ERROR_BUTTON"},f=e=>{let{attributes:t,children:n,element:r}=e,[o]=(0,p.KO)(u.jV),l=(0,a.YI)(r);switch(r.type){case h.PARAGRAPH:var d;if((null===(d=r.children.at(0))||void 0===d?void 0:d.text)==="")return(0,i.jsx)(b,{...t,children:n});return(0,i.jsx)(m,{...t,...l,children:n});case h.OPTIONS_BUTTON:return(0,i.jsx)(x,{...t,...r,color:o,wordTransitionState:l,children:n});case h.TEMPO_BUTTON:return(0,i.jsx)(v,{...t,...r,color:o,wordTransitionState:l,children:n});case h.ERROR_BUTTON:return(0,i.jsx)(g,{...t,...r,wordTransitionState:l,children:n});default:return(0,i.jsx)("p",{...t,children:n})}},m=(0,r.ZP)(s.vC).withConfig({componentId:"sc-231acf9d-0"})(["",";"],d.BU),v=(0,r.ZP)(l.J).withConfig({componentId:"sc-231acf9d-1"})(["",";"],d.BU),x=(0,r.ZP)(o.hp).withConfig({componentId:"sc-231acf9d-2"})(["",";"],d.BU),g=(0,r.ZP)(c.FT).withConfig({componentId:"sc-231acf9d-3"})(["",";"],d.BU),b=r.ZP.span.withConfig({componentId:"sc-231acf9d-4"})(["",";margin:0;width:1px;margin-left:-1px;display:inline-block;"],d.BU)},39918:function(e,t,n){n.d(t,{_:function(){return a}});var i=n(85893),r=n(67294),o=n(964),l=n(85518);let a=(0,r.forwardRef)((e,t)=>{let{children:n,attributes:r}=e;return(0,i.jsxs)("div",{...r,ref:t,children:[n,!l.tq&&(0,i.jsx)(d,{children:"tab"})]})}),d=o.ZP.div.withConfig({componentId:"sc-d949c0f1-0"})(["display:inline-flex;width:min-content;font-size:0.58em;line-height:100%;padding:0.5rem 0.75rem 0.4rem 0.7rem;border-radius:8px;margin-left:0.75rem;transform:translateY(-0.2em);border:1px solid ",";background-color:",";"],e=>{let{theme:t}=e;return t.colors["md-grey-100"]},e=>{let{theme:t}=e;return t.colors["md-grey-700"]})},89212:function(e,t,n){n.d(t,{h:function(){return g}});var i=n(85893),r=n(5152),o=n.n(r),l=n(18156),a=n(964),d=n(96391),s=n(77493),c=n(95244),u=n(67294),p=n(8728);let h=e=>{let{attributes:t,children:n}=e;return(0,i.jsx)("span",{...t,children:n})};var f=n(56674);let m=o()(async()=>(await Promise.resolve().then(n.bind(n,96391))).Editable,{loadableGenerated:{webpack:()=>[96391]},ssr:!1}),v=(e,t)=>{let n=s.ML.marks(e);return!!n&&!0===n[t]},x=(e,t)=>{v(e,t)?s.ML.removeMark(e,t):s.ML.addMark(e,t,!0)},g=e=>{let{className:t,onSubmit:n,...r}=e,o=(0,d.useSlate)(),a=(0,u.useCallback)(e=>(0,i.jsx)(p.W,{...e}),[]),s=(0,u.useCallback)(e=>(0,i.jsx)(h,{...e}),[]);return(0,u.useEffect)(()=>{let e=e=>{var t,n,i;if("Delete"!==e.key&&"Backspace"!==e.key||!d.ReactEditor.isFocused(o)||!(null===(t=o.selection)||void 0===t?void 0:t.anchor))return!1;let r=(0,f.ck)({editor:o,point:null===(n=o.selection)||void 0===n?void 0:n.anchor});if(!r||!c.tk.includes(null==r?void 0:r.type)||!d.ReactEditor.toDOMNode(o,r))return!1;e.preventDefault();let l=null!==(i=(0,f.cX)(r))&&void 0!==i?i:"";return(0,f.R1)({id:r.id,newSlateElement:(0,f.IU)(l),editor:o}),!0},t=t=>{e(t)||o.children.filter(e=>e.type!==p.x.PARAGRAPH).map(e=>d.ReactEditor.toDOMNode(o,e)).forEach(e=>{e.classList.remove(c.NJ)})};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[o]),(0,i.jsx)(b,{className:t,renderElement:a,renderLeaf:s,onKeyDown:e=>{if("Enter"===e.key){e.preventDefault(),n();return}for(let t in c.LM)(0,l.ZP)(t,e)&&(e.preventDefault(),x(o,c.LM[t]));if("Tab"===e.key){if("string"!=typeof r.placeholder||(0,f.Mv)(o.children).length>0)return;e.preventDefault(),o.insertNode((0,f.IU)(r.placeholder))}},onCopy:e=>{var t,n;let i=null===(t=o.selection)||void 0===t?void 0:t.anchor.path.at(0),r=null===(n=o.selection)||void 0===n?void 0:n.focus.path.at(0);if("number"!=typeof i||"number"!=typeof r)return;let[l,a]=[i,r].sort((e,t)=>e-t);if("number"!=typeof l||"number"!=typeof a)return;let d=o.children.slice(l,a+1).map(e=>(0,f.cX)(e)).filter(Boolean).join(" ");e.preventDefault(),navigator.clipboard.writeText(d)},...r})},b=(0,a.ZP)(m).withConfig({componentId:"sc-97ca6a58-0"})(["line-height:2;height:100%;&:focus{outline:none;}&::-webkit-scrollbar{width:0.25rem;}&::-webkit-scrollbar-thumb{border-radius:2px;background-color:",";}"],e=>e.theme.colors["md-white"])},17324:function(e,t,n){n.d(t,{nU:function(){return v},vC:function(){return m}});var i=n(85893),r=n(67294),o=n(73935),l=n(58868),a=n(38439),d=n(48583),s=n(964),c=n(96934),u=n(62288),p=n(45329);let h=e=>{let{text:t,textRef:n,oldRect:o,oldColor:a,newRect:s,onAnimationStart:u,onAnimationComplete:p,onPositionNear:h}=e,[f]=(0,d.KO)(c.Cl),[m,v]=(0,r.useState)(),[x,g]=(0,r.useState)(),w=(0,r.useRef)(!1);(0,l.L)(()=>{f.portalContainer&&v(f.portalContainer.getBoundingClientRect())},[f.portalContainer]),(0,l.L)(()=>{(null==n?void 0:n.current)&&g(window.getComputedStyle(n.current).color)},[n]);let y=(0,r.useId)(),P=o&&s&&m,T=(0,r.useCallback)(e=>{if(!h||!s||!m)return;let t=Math.abs((Number(e.x)||0)-(s.x-m.x)),n=Math.abs((Number(e.y)||0)-(s.y-m.y));!w.current&&t<=4&&n<=4&&(h(),w.current=!0)},[h,s,m]);if(!P)return;let C={x:o.x-m.x,y:o.y-m.y},O=C.y/(3*o.height)*.5+C.x/m.width*.1,j={key:y,initial:{...C,lineHeight:"".concat(o.height,"px"),color:a},animate:{x:s.x-m.x,y:s.y-m.y,lineHeight:"".concat(s.height,"px"),color:x},transition:{type:"spring",bounce:0,damping:25,delay:O,color:{delay:O+.8,duration:.125}}};return(0,i.jsx)(b,{...j,onAnimationStart:u,onUpdate:T,onAnimationComplete:p,children:t})},f=e=>{let{oldRects:t,newRects:n,textRef:l,onPositionsNear:a,onAnimationComplete:s}=e,[u]=(0,d.KO)(c.Cl),[p,f]=(0,r.useState)(0),[m,v]=(0,r.useState)(0),x=(0,r.useRef)(!1);(0,r.useEffect)(()=>{x.current&&(m<=0&&(null==a||a()),p<=0&&(null==s||s()))},[t,a,s,m,p]);let b=(0,r.useCallback)(()=>{x.current=!0,f(e=>e+1),v(e=>e+1)},[]),w=(0,r.useCallback)(()=>{f(e=>e-1)},[]),y=(0,r.useCallback)(()=>{v(e=>e-1)},[]);return n&&t&&u.portalContainer&&(0,o.createPortal)((0,i.jsx)(g,{"aria-hidden":!0,children:n.map((e,n)=>{let r=t[n];return r&&(0,i.jsx)(h,{text:e.text,oldRect:r.rect,oldColor:r.color,newRect:e.rect,textRef:l,onAnimationStart:b,onPositionNear:y,onAnimationComplete:w},n)})}),u.portalContainer)},m=(0,r.forwardRef)((e,t)=>{let{className:n,textRef:r,transitioning:o,endTransitions:l,wordTransitions:a,onPositionsNear:d,children:s,...c}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{ref:(0,p.lq)(t,r),className:n,...c,children:(0,i.jsx)(w,{$hidden:!!o,children:s})}),o&&(0,i.jsx)(f,{...a,textRef:r,onPositionsNear:d,onAnimationComplete:l})]})}),v=e=>{let{className:t}=e,[,n]=(0,d.KO)(c.Cl),o=(0,r.useCallback)(e=>{n(t=>({...t,portalContainer:e}))},[n]);return(0,i.jsx)(x,{"aria-hidden":!0,ref:o,className:t})},x=s.ZP.div.withConfig({componentId:"sc-3167d3cc-0"})(["pointer-events:none;"]),g=(0,s.ZP)(a.E.div).withConfig({componentId:"sc-3167d3cc-1"})(["position:absolute;top:0;left:0;"]),b=(0,s.ZP)(a.E.span).withConfig({componentId:"sc-3167d3cc-2"})(["display:inline-block;position:absolute;top:0;left:0;white-space:nowrap;",""],u.BU),w=s.ZP.span.withConfig({componentId:"sc-3167d3cc-3"})(["opacity:",";"],e=>e.$hidden?0:1)},95244:function(e,t,n){n.d(t,{LM:function(){return o},NJ:function(){return l},Zc:function(){return r},tk:function(){return a}});var i=n(8728);let r=[(0,n(56674).IU)()],o={},l="highlighted",a=[i.x.OPTIONS_BUTTON,i.x.TEMPO_BUTTON,i.x.ERROR_BUTTON]},53194:function(e,t,n){n.d(t,{FT:function(){return h},p9:function(){return g},u$:function(){return x}});var i=n(85893),r=n(23630),o=n(8728),l=n(17324),a=n(80423),d=n(62288),s=n(45329),c=n(67294),u=n(96391),p=n(964);let h=(0,c.forwardRef)((e,t)=>{let{id:n,errorText:r,wordTransitionState:o,className:l,children:d}=e,s=(0,u.useSlate)(),c=(0,a.q4)(o);return(0,i.jsxs)(f,{onClick:()=>{let e=s.children.findIndex(e=>e.id===n);if(-1===e)throw Error("Could not find element");s.delete({at:[e]})},contentEditable:!1,ref:t,className:l,children:[d,(0,i.jsx)(m,{...o,onPositionsNear:c.onPositionsNear,children:r}),(0,i.jsx)(v,{icon:"close",color:"white"})]})}),f=p.ZP.button.withConfig({componentId:"sc-297414eb-0"})(["flex:0;display:inline-flex;align-items:center;flex-wrap:nowrap;justify-content:space-between;height:fit-content;max-width:-webkit-fill-available;color:white;background-color:",";border:1px solid ",";margin-right:0.5rem;padding:0 0.5rem 0 1rem;border-radius:0.75rem;&.highlighted{",";}@media (max-width:","){border-radius:0.75rem;padding:0 0.5rem 0 0.75rem;}@media (max-width:","){border-radius:0.5rem;padding:0 0.25rem 0 0.75rem;}@media (max-width:","){padding:0 0.25rem 0 0.5rem;}"],e=>e.theme.colors["md-grey-900"],e=>e.theme.colors["md-grey-700"],d.ZX,e=>e.theme.breakpoints["laptop-large"],e=>e.theme.breakpoints.laptop,e=>e.theme.breakpoints.tablet),m=(0,p.ZP)(l.vC).withConfig({componentId:"sc-297414eb-1"})(["isolation:isolate;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-decoration:underline;text-decoration-color:red;text-decoration-style:wavy;text-decoration-thickness:2px;"]),v=(0,p.ZP)(r.O).withConfig({componentId:"sc-297414eb-2"})(["padding:0.25rem;"]),x=e=>e.errorText,g=e=>({id:(0,s.vV)(),type:o.x.ERROR_BUTTON,children:[{text:""}],...e})},23126:function(e,t,n){n.d(t,{hp:function(){return b},lV:function(){return k},p6:function(){return j}});var i=n(85893),r=n(67294),o=n(964),l=n(95059),a=n(38439),d=n(8728),s=n(56674),c=n(96391),u=n(45329),p=n(70182),h=n(80423),f=n(17324),m=n(62288),v=n(94049),x=n(48583),g=n(96934);let b=(0,r.forwardRef)((e,t)=>{var n;let{id:o,color:a,options:d,currentOption:f,wordTransitionState:m,children:b,className:j}=e,[k,E]=(0,r.useState)(f),R=(0,c.useSlate)(),[N,I]=(0,r.useState)(!1),_=(0,r.useRef)(null),S=(0,r.useRef)(null),Z=(0,p.O)(_),[M]=(0,x.KO)(g.hZ),A=(0,u.G9)({color:a,seed:d.reduce((e,t)=>e+t.label.length,0)}),B=(0,h.q4)(m),U="auto",$="auto";(null==Z?void 0:Z.width)!=="auto"&&(U="".concat(null==Z?void 0:Z.width,"px")),(null==Z?void 0:Z.height)!=="auto"&&($="".concat(null==Z?void 0:Z.height,"px"));let L={ease:[.32,.01,.015,.995],duration:.3,delay:M?0:.125};return(0,i.jsxs)(l.fC,{open:N,onOpenChange:e=>{I(e)},value:k.label,onValueChange:e=>{let t=d.find(t=>t.label===e);if(!t)throw Error("couldn't find the option that was just selected!");(0,s.R1)({id:o,newSlateElement:{currentOption:t},editor:R}),E(t)},children:[(0,i.jsxs)(w,{ref:(0,u.lq)(t,_),...B.containerProps,contentEditable:!1,className:j,children:[(0,i.jsx)(y,{...B.backgroundProps,$backgroundColor:A}),(0,i.jsx)(l.B4,{asChild:!0,children:(0,i.jsx)(P,{...m,onPositionsNear:B.onPositionsNear,children:k.label})}),(0,i.jsx)(v.F,{isOpen:N}),b]}),(0,i.jsx)(l.h_,{children:(0,i.jsx)(l.VY,{position:"popper",sideOffset:-Number(Z.height)||0,ref:e=>{e&&(e.ontouchstart=e=>{e.preventDefault()})},children:(0,i.jsxs)(l.l_,{children:[(0,i.jsx)(T,{$backgroundColor:A,initial:{width:U,height:$},animate:{width:N?"100%":U,height:N?"100%":$},transition:L}),(0,i.jsxs)(l.ZA,{ref:S,children:[(0,i.jsxs)(O,{value:k.label,$backgroundColor:A,className:j,children:[(0,i.jsx)(l.eT,{children:k.label}),(0,i.jsx)(C,{animate:{flexGrow:N?1:0},transition:L,children:(0,i.jsx)(v.F,{isOpen:N})})]}),null===(n=d.filter(e=>e.label!==k.label))||void 0===n?void 0:n.map(e=>(0,i.jsx)(O,{value:e.value,$backgroundColor:A,className:j,children:(0,i.jsx)(l.eT,{children:e.label})},e.value))]})]})})})]})}),w=(0,o.ZP)((0,a.E)(l.xz)).withConfig({componentId:"sc-b5404f9b-0"})(["flex:0;display:inline-flex;align-items:center;flex-wrap:nowrap;justify-content:space-between;height:fit-content;max-width:-webkit-fill-available;color:black;margin-right:0.5rem;padding:0 0.25rem 0 0.5rem;position:relative;&:focus{outline:none;}span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}@media (max-width:","){border-radius:0.25rem;margin-right:0.25rem;}"],e=>e.theme.breakpoints.laptop),y=(0,o.ZP)(a.E.div).withConfig({componentId:"sc-b5404f9b-1"})(["",";.highlighted &{",";}"],m.mV,m.ZX),P=(0,o.ZP)(f.vC).withConfig({componentId:"sc-b5404f9b-2"})(["isolation:isolate;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;"]),T=(0,o.ZP)(a.E.div).withConfig({componentId:"sc-b5404f9b-3"})(["background-color:",";border-radius:0.5rem;left:0;position:absolute;top:0;@media (max-width:","){border-radius:0.25rem;}"],e=>e.$backgroundColor,e=>e.theme.breakpoints.laptop),C=(0,o.ZP)(a.E.div).withConfig({componentId:"sc-b5404f9b-4"})(["display:flex;justify-content:flex-end;"]),O=(0,o.ZP)(l.ck).withConfig({componentId:"sc-b5404f9b-5"})(["flex:0;display:flex;align-items:center;justify-content:flex-start;height:fit-content;color:hsla(0,0%,0%,0.3);position:relative;transition:color 0.2s;padding:0 1rem 0 0.5rem;@keyframes fadeIn{75%{opacity:0;transform:translateY(5px);}100%{opacity:1;transform:translateY(0px);}}&:focus{outline:none;}&:hover{cursor:pointer;color:black;}&:first-of-type{color:black;padding-right:0.25rem;@media (min-width:","){padding-right:0.5rem;}}&:not(:first-of-type){opacity:0;transform:translateY(10px);animation:fadeIn 0.4s ease-out forwards;}"],e=>e.theme.breakpoints.laptop),j=e=>e.currentOption.value,k=e=>({id:(0,u.vV)(),type:d.x.OPTIONS_BUTTON,children:[{text:""}],...e})},97992:function(e,t,n){n.d(t,{E_:function(){return E},J:function(){return g},Wj:function(){return R}});var i=n(85893),r=n(67294),o=n(68482),l=n(964),a=n(96391),d=n(65820),s=n(38439),c=n(8728),u=n(23630),p=n(56674),h=n(45329),f=n(70182),m=n(80423),v=n(17324),x=n(62288);let g=(0,r.forwardRef)((e,t)=>{let{id:n,tempos:l,currentTempo:c,className:x,color:g,wordTransitionState:E,children:R}=e,N=(0,a.useSlate)(),I=(0,r.useRef)(null),_=(0,m.q4)(E),[S,Z]=(0,r.useState)(l.indexOf(c)),[M,A]=(0,r.useState)(!1),B=(0,r.useCallback)(e=>{let[t]=e;Z(t)},[]),U=(0,h.G9)({color:g,seed:l.reduce((e,t)=>e+t.length,0)}),$=(0,r.useCallback)(()=>{let e=Math.round(S),t=l[e];t&&(Z(e),(0,p.R1)({id:n,newSlateElement:{currentTempo:t},editor:N}))},[S,l,n,N]),L=l[Math.round(S)];if(!L)throw Error("You set the value to an index not present in the tempos array!");let V=S/(l.length-1),D=(0,f.O)(I),z="auto";return(null==D?void 0:D.height)!=="auto"&&(z=M?"".concat((null==D?void 0:D.height)+48,"px"):"".concat(null==D?void 0:D.height,"px")),(0,i.jsx)(d.M,{children:(0,i.jsx)(s.E.span,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:(0,i.jsxs)(b,{..._.containerProps,ref:t,contentEditable:!1,$isOpen:M,$height:z,className:x,children:[(0,i.jsx)(w,{..._.backgroundProps,$backgroundColor:U}),(0,i.jsxs)(T,{onClick:()=>{A(!M)},ref:I,children:[(0,i.jsx)(v.vC,{...E,onPositionsNear:_.onPositionsNear,children:L}),(0,i.jsx)(u.O,{isOutlined:!0,color:"currentColor",icon:M?"arrow_drop_up":"arrow_drop_down",size:"inherit"})]}),(0,i.jsx)(d.M,{children:M&&(0,i.jsx)(y,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0,transition:{delay:.1}},exit:{opacity:0,y:-10},children:(0,i.jsx)(o.fC,{asChild:!0,min:0,max:l.length-1,step:.01,value:[S],onValueChange:B,onValueCommit:$,children:(0,i.jsxs)(P,{children:[(0,i.jsx)(C,{}),(0,i.jsx)(O,{$shiftPercentage:V}),(0,i.jsx)(j,{$shiftPercentage:V})]})})},"tempo-slider-content")}),(0,i.jsx)(k,{children:R})]})})})}),b=(0,l.ZP)(s.E.button).withConfig({componentId:"sc-dee643d4-0"})(["color:black;display:inline-flex;align-items:center;flex-direction:column;position:relative;height:",";min-width:",";padding:0 0.5rem 0 1rem;margin-right:0.5rem;transition:",";user-select:none;&:focus{outline:none;}&:hover{cursor:pointer;}border-radius:16px;"],e=>e.$height,e=>e.$isOpen?"100%":"auto",e=>e.$isOpen?"height 0.3s ease":"height 0.3s ease .2s"),w=(0,l.ZP)(s.E.div).withConfig({componentId:"sc-dee643d4-1"})(["",";.highlighted &{",";}"],x.mV,x.ZX),y=(0,l.ZP)(s.E.div).withConfig({componentId:"sc-dee643d4-2"})(["width:100%;padding:0.5rem 0.75rem 1rem 0;"]),P=l.ZP.div.withConfig({componentId:"sc-dee643d4-3"})(["cursor:pointer;position:relative;display:flex;align-items:center;user-select:none;touch-action:none;"]),T=l.ZP.div.withConfig({componentId:"sc-dee643d4-4"})(["isolation:isolate;display:flex;align-items:center;justify-content:space-between;text-align:left;width:100%;"]),C=(0,l.ZP)(o.fQ).withConfig({componentId:"sc-dee643d4-5"})(["height:1.5rem;background-color:black;filter:opacity(0.25);border-radius:15px;flex-grow:1;overflow:hidden;position:relative;"]),O=(0,l.ZP)(o.e6).withConfig({componentId:"sc-dee643d4-6"})(["height:2rem;height:100%;background-color:white;filter:opacity(0.75);position:absolute;border-radius:16px;border-top-right-radius:calc(16px * ",");border-bottom-right-radius:calc(16px * ",");"],e=>e.$shiftPercentage,e=>e.$shiftPercentage),j=(0,l.ZP)(o.bU).withConfig({componentId:"sc-dee643d4-7"})(["--size:1.5rem;display:block;aspect-ratio:1;background-color:black;border-radius:50px;height:var(--size);width:var(--size);--size-shift:calc(-1 * var(--size) / 2);top:var(--size-shift);left:max( calc( var(--size-shift) + (var(--size-shift) * (1 - ",")) ),var(--size-shift) );position:absolute;"],e=>e.$shiftPercentage),k=l.ZP.div.withConfig({componentId:"sc-dee643d4-8"})(["display:none;"]),E=e=>e.currentTempo,R=e=>({id:(0,h.vV)(),type:c.x.TEMPO_BUTTON,children:[{text:""}],...e})},56674:function(e,t,n){n.d(t,{IU:function(){return c},Mv:function(){return m},R1:function(){return p},Y:function(){return v},aP:function(){return h},b1:function(){return x},cX:function(){return f},ck:function(){return u},mD:function(){return g}});var i=n(8728),r=n(23126),o=n(97992),l=n(2125),a=n(45329),d=n(53194),s=n(92658);let c=e=>({id:(0,a.vV)(),type:i.x.PARAGRAPH,children:[{text:null!=e?e:""}]}),u=e=>{let{point:t,editor:n}=e,i=n.children,r=null==t?void 0:t.path.at(0),o=null==t?void 0:t.offset;if("number"==typeof o&&"number"==typeof r)return 0===r&&0===o?i[0]:0===o?i[r-1]:i[r]},p=e=>{let{id:t,newSlateElement:n,editor:i}=e,r=i.children.findIndex(e=>e.id===t),o=i.children[r];if(-1===r||!o){console.error("could not find node to replace!");return}i.delete({at:[r]}),i.insertNode({...o,...n},{at:[r]})},h=e=>{var t,n;let{prompt:a,enhancedPrompt:u,toolName:p}=e,h=[...u.candidates||[]];h.sort((e,t)=>{var n,i;return((null==t?void 0:null===(n=t.pivotedText)||void 0===n?void 0:n.length)||0)-((null==e?void 0:null===(i=e.pivotedText)||void 0===i?void 0:i.length)||0)}),h.forEach(e=>{var t;null===(t=e.pivots)||void 0===t||t.forEach(e=>{e.pivotOptions=[...new Set(e.pivotOptions)]})});let f=h.reduce((e,t,n)=>{var i,r,o,l,a;return t.pivotedText&&(null==t?void 0:null===(i=t.pivots)||void 0===i?void 0:i.length)&&((null==t?void 0:null===(r=t.pivots)||void 0===r?void 0:r.length)&&(null==t||null===(o=t.pivots)||void 0===o||o.length),e["{".concat(n,"}")]={label:t.pivotedText,type:(null===(l=t.pivots[0])||void 0===l?void 0:l.type)||"PROMPT_PIVOT_TYPE_UNSPECIFIED",pivotOptions:[...(null===(a=t.pivots[0])||void 0===a?void 0:a.pivotOptions)||[]]}),e},{}),m=h.reduce((e,t,n)=>{if(!t.pivotedText)return e;let i=RegExp("({)?("+t.pivotedText+")(})?","g");return e.replaceAll(i,(e,t,i,r)=>t&&r&&/^[0-9]*$/.test(i)?e:"{".concat(n,"}"))},a).split(/(\{\d+\})/g).map(e=>{var t;let n=f[e.replaceAll(/[.,()-]/g,"")];if(p!==s.dx.IMAGE_FX&&p!==s.dx.MUSICLM_V2)return c(e);let i=[null!==(t=null==n?void 0:n.label)&&void 0!==t?t:"",...(null==n?void 0:n.pivotOptions)||[]].filter(Boolean);switch(null==n?void 0:n.type){case s.ur.PROMPT_PIVOT_TYPE_DEFAULT:return(0,r.lV)({currentOption:{value:n.label,label:n.label},options:i.map(e=>({value:e,label:e}))});case s.ur.PROMPT_PIVOT_TYPE_MUSICFX_TEMPO:{let e=n.label,t=l.wM.includes(e)?l.wM:[e,...l.wM];return(0,o.Wj)({tempos:t,currentTempo:e})}case s.ur.PROMPT_PIVOT_TYPE_NAME:return(0,d.p9)({errorText:n.label});default:return c(e)}});return(null===(t=m.at(0))||void 0===t?void 0:t.type)!==i.x.PARAGRAPH&&m.unshift(c()),(null===(n=m.at(-1))||void 0===n?void 0:n.type)!==i.x.PARAGRAPH&&m.push(c()),m},f=e=>{switch(e.type){case i.x.TEMPO_BUTTON:return(0,o.E_)(e);case i.x.OPTIONS_BUTTON:return(0,r.p6)(e);case i.x.ERROR_BUTTON:return(0,d.u$)(e);case i.x.PARAGRAPH:default:return e.children.map(e=>e.text.trim()).filter(e=>!!e).join(" ")}},m=e=>e.map(f).filter(e=>!!e).map(e=>e.trim()).join(" ").trim(),v=e=>e.map((e,t)=>[i.x.TEMPO_BUTTON,i.x.OPTIONS_BUTTON].includes(e.type)?"$$ENHANCED_".concat(t,"$$"):f(e)).filter(e=>!!e).map(e=>e.trim()).join(" ").trim(),x=e=>e.filter(e=>[i.x.TEMPO_BUTTON,i.x.OPTIONS_BUTTON].includes(e.type)).map(e=>f(e)).filter(Boolean),g=e=>{let{text:t,editor:n}=e;n.delete({at:{anchor:n.start([]),focus:n.end([])}}),n.insertNodes([{id:(0,a.vV)(),type:i.x.PARAGRAPH,children:[{text:t}]}])}},80423:function(e,t,n){n.d(t,{YI:function(){return f},Yb:function(){return h},q4:function(){return m}});var i=n(96391),r=n(56674),o=n(67294),l=n(48583),a=n(96934),d=n(58868);let s=(e,t)=>{if(e.nodeType===Node.TEXT_NODE)return{node:e,position:t};for(let i of e.childNodes){var n;let e=(null==i?void 0:null===(n=i.textContent)||void 0===n?void 0:n.length)||0;if(t<=e)return s(i,t);t-=e}},c=e=>{var t,n;let{text:i,word:r,startPosition:o=0}=e,l=r.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),a=i.substring(o).match(RegExp("^(?<spaces>\\s*)(?<word>".concat(l,")"),"i"));if(!a)return;let d=o+((null===(n=a.groups)||void 0===n?void 0:null===(t=n.spaces)||void 0===t?void 0:t.length)||0);return{startPosition:d,endPosition:d+r.length}},u=e=>{let{startPosition:t,endPosition:n,domNode:i}=e,r=document.createRange();try{var o;let e=s(i,t),l=s(i,n);if(!l)return;let a=0===t&&!(null==e?void 0:e.node)&&(null===(o=s(i,1))||void 0===o?void 0:o.node);r.setStart((null==e?void 0:e.node)||a||i,(null==e?void 0:e.position)||0),r.setEnd((null==l?void 0:l.node)||i,(null==l?void 0:l.position)||0)}catch(e){console.error(e);return}return r.getBoundingClientRect()},p=e=>{let{text:t,domNode:n}=e,i=0;return t.split(" ").reduce((e,t)=>{let r=c({word:t,text:n.innerText,startPosition:i});if(!r)return e;let o=u({...r,domNode:n});return o&&(i=r.endPosition,e.push({text:t,rect:o})),e},[])},h=e=>{let{editor:t,newElements:n}=e,o=0,l=0;return n.reduce((e,n)=>{let a=(0,r.cX)(n),d=t.children;return(null==a?void 0:a.trim())&&(e[n.id]=a.split(" ").reduce((e,n)=>(d.find((a,d)=>{if(o>d)return;let s=(0,r.cX)(a),p=c({word:n,text:s,startPosition:l});if(!p)return;let h=i.ReactEditor.toDOMNode(t,a);if(!h)return;let f=u({...p,domNode:h});if(f)return l=p.endPosition,p.endPosition>=s.length&&(o=d+1,l=0),e.push({text:n,rect:f,color:window.getComputedStyle(h).color}),!0}),e),[])),e},{})},f=e=>{var t;let n=(0,o.useRef)(null),[i,s]=(0,l.KO)(a.Cl),[c,u]=(0,o.useState)(),h=null===(t=i.oldWordRects)||void 0===t?void 0:t[e.id],[f,m]=(0,o.useState)(h&&(null==h?void 0:h.length)>0);return(0,d.L)(()=>{if(!n.current||!h)return;let t=p({text:(0,r.cX)(e),domNode:n.current});u(null==t?void 0:t.map(e=>({text:e.text,rect:e.rect})))},[h,e]),{textRef:n,transitioning:f,endTransitions:(0,o.useCallback)(()=>{m(!1),s(t=>{let n=t.oldWordRects;return n?{...t,oldWordRects:Object.keys(n).reduce((t,i)=>i!==e.id&&n[i]?{...t,[i]:n[i]}:t,{})}:{...t}})},[e.id,s]),wordTransitions:{oldRects:h,newRects:c}}},m=e=>{let t=(0,o.useRef)(null),[n,i]=(0,o.useState)(!(null==e?void 0:e.transitioning)),r=(null==e?void 0:e.transitioning)&&!n,l={opacity:r?0:1},a={scale:r?.9:1},d={type:"spring",bounce:0};return{containerRef:t,onPositionsNear:()=>i(!0),containerProps:{initial:l,animate:l,transition:d},backgroundProps:{initial:a,animate:a,transition:d}}}},4255:function(e,t,n){n.d(t,{n:function(){return d}});var i=n(85893),r=n(964),o=n(96219),l=n(23630),a=n(39134);let d=e=>{let{color:t,label:n,labelId:r,helperText:d,icon:v,onIconClick:x,iconProps:g,...b}=e;return(0,i.jsx)(a.b,{colorTheme:t,children:(0,i.jsxs)(s,{children:[(0,i.jsxs)(c,{htmlFor:r,$isDisabled:null==b?void 0:b.disabled,children:[(0,i.jsxs)(u,{children:[(0,i.jsx)(p,{children:n}),(0,i.jsx)(h,{id:r,...b})]}),v&&(0,i.jsxs)(f,{onClick:x,children:[(0,i.jsx)(l.O,{icon:v,iconSet:l.G.GOOGLE_SYMBOLS,...g}),(0,i.jsx)(o.f,{children:v})]})]}),d&&(0,i.jsx)(m,{children:d})]})})},s=r.ZP.div.withConfig({componentId:"sc-90057895-0"})(["flex:1;"]),c=r.ZP.label.withConfig({componentId:"sc-90057895-1"})(["display:flex;flex:1;justify-content:space-between;flex-direction:row;border-radius:8px;background-color:",";color:",";padding:0.5rem 0.25rem 0.5rem 1rem;",""],e=>e.theme.colors["aitk-white-05"],e=>e.theme.colors["aitk-white-50"],e=>e.$isDisabled?(0,r.iv)(["opacity:0.65;"]):(0,r.iv)(["&:hover:not(:focus-within){background-color:",";}"],e=>e.theme.colors["aitk-white-15"])),u=r.ZP.div.withConfig({componentId:"sc-90057895-2"})(["display:flex;flex:1;flex-direction:column;"]),p=r.ZP.span.withConfig({componentId:"sc-90057895-3"})(["",";"],e=>e.theme.typography.mdBodySmall),h=r.ZP.input.withConfig({componentId:"sc-90057895-4"})(["border:none;outline:none;",";background-color:transparent;width:100%;caret-color:",";color:",";"],e=>e.theme.typography.mdBodyLarge,e=>e.theme.colors["md-white"],e=>e.theme.colors["md-white"]),f=r.ZP.button.withConfig({componentId:"sc-90057895-5"})(["display:flex;align-items:center;padding:0.5rem;border-radius:12px;background-color:transparent;transition:background-color 0.2s;&:hover{background-color:",";}&:active{background-color:",";}"],e=>e.theme.colors["aitk-white-15"],e=>e.theme.colors["aitk-white-50"]),m=r.ZP.p.withConfig({componentId:"sc-90057895-6"})(["color:",";",";padding:0.3rem 0 0 1rem;"],e=>e.theme.colors["md-grey-500"],e=>e.theme.typography.mdLabelSmall)},18399:function(e,t,n){n.d(t,{u:function(){return s}});var i=n(85893),r=n(964),o=n(66908),l=n(67294),a=n(65820),d=n(38439);let s=e=>{let{children:t,content:n,delay:r=700,sideOffset:d=-20,forceOpen:s,disabled:u,className:p}=e,[h,f]=(0,l.useState)(!1);return(0,i.jsx)(o.zt,{delayDuration:r,children:(0,i.jsxs)(o.fC,{open:s||h,onOpenChange:f,children:[(0,i.jsx)(o.xz,{asChild:!0,children:t}),(0,i.jsx)(a.M,{children:h&&(0,i.jsx)(o.h_,{forceMount:!0,children:(0,i.jsx)(o.VY,{hideWhenDetached:!0,sideOffset:d,asChild:!0,children:!u&&(0,i.jsx)(c,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{type:"spring",duration:.25},className:p,children:n})})})})]})})},c=(0,r.ZP)(d.E.div).withConfig({componentId:"sc-978aa07b-0"})([""," background-color:",";border-radius:12px;color:",";max-width:16.25rem;padding:0.3125rem 0.625rem;padding:0.75rem 1rem;position:relative;top:-0.625rem;transform-origin:bottom;&::before{content:'';background:",";border-radius:4px;bottom:-6px;height:24px;left:50%;position:absolute;transform:translateX(-50%) rotate(45deg);width:24px;z-index:-1;}"],e=>e.theme.typography.textFxBody1,e=>e.theme.colors["md-white"],e=>e.theme.colors["md-grey-800"],e=>e.theme.colors["md-white"])},79962:function(e,t,n){n.d(t,{s:function(){return r}});var i=n(28189);let r=e=>{var t;let{tool:n,enabled:r}=e,o=i.h.general.fetchToolAvailability.useQuery({tool:n},{retry:!1,cacheTime:0,enabled:r}),l=(null===(t=o.data)||void 0===t?void 0:t.result.availabilityState)==="AVAILABLE";return{...o,data:l}}},25683:function(e,t,n){n.d(t,{X:function(){return o}});var i=n(67294),r=n(964);let o=e=>{let t=(0,r.Fg)(),[n,o]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{let n=()=>{o(window.innerWidth>=parseInt(t.breakpoints[e]))};return n(),window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[t,e]),n}},16058:function(e,t,n){n.d(t,{T:function(){return s}});var i=n(25683),r=n(96934),o=n(4960),l=n(4002),a=n(48583),d=n(67294);let s=e=>{let{inputContainerRef:t,isInputContainerFocused:n}=e,[s]=(0,a.KO)(r.oH),c=(0,i.X)("laptop"),u=(0,d.useRef)(0),p=(0,o.c)(0),h=(0,l.q)(p,{bounce:0,stiffness:1e3,damping:100,mass:1}),f=(0,d.useRef)();return(0,d.useEffect)(()=>{var e,i;if(!n){t.current&&(u.current=t.current.offsetHeight,p.set(u.current));return}let r=()=>{window.scrollTo(0,0),document.body.scrollTop=0};r(),f.current=setTimeout(r,250),u.current=(null===(e=t.current)||void 0===e?void 0:e.offsetHeight)||0,p.set(u.current);let o=()=>{var e;p.set(((null===(e=window.visualViewport)||void 0===e?void 0:e.height)||0)-((null==s?void 0:s.height)||0))};return o(),null===(i=window.visualViewport)||void 0===i||i.addEventListener("resize",o),()=>{var e;clearTimeout(f.current),null===(e=window.visualViewport)||void 0===e||e.removeEventListener("resize",o)}},[s,t,n,p]),{inputContainerHeight:!c&&n?h:"auto"}}},3959:function(e,t,n){n.d(t,{Y:function(){return s}});var i=n(67421),r=n(12944),o=n(92658),l=n(48583),a=n(96934),d=n(28189);let s=e=>{let{toolName:t,onSuccess:n}=e,[s]=(0,l.KO)(a.Zb),{t:c}=(0,i.$G)(),u=(0,r.p)(),p=d.h.media.generateEnhancedPrompt.useMutation(),h=async e=>{let{prompt:i,id:r}=e,l={clientContext:{sessionId:s,tool:t},userInput:{textPrompt:i}};p.mutate(l,{onError:()=>u({text:c("imagefx_enhance_prompt_error"),type:o.$n.ERROR}),onSuccess:e=>n({data:e.result,input:l,id:r})})};return{...p,fetchEnhancedPrompt:h}}}}]);